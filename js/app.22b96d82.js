(function(){"use strict";var t={7893:function(t,n,e){var o=e(9242),s=e(2483),a=e(3396);function r(t,n){const e=(0,a.up)("RouterView");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(e)])}var i=e(89);const c={},l=(0,i.Z)(c,[["render",r]]);var u=l,d=(e(560),e(7139)),p=e.p+"img/back-arrow.7698bcbe.svg",h=e.p+"img/trash-bin.56053ce9.svg";const m={class:"task-list"},f=["checked","onClick"],k=["onClick"];function g(t,n,e,s,r,i){const c=(0,a.up)("app-modal-confirmation");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("header",null,[(0,a._)("h1",null,(0,d.zw)(r.note.title),1),(0,a._)("img",{onClick:n[0]||(n[0]=n=>t.$router.push({name:"StartingPage"})),src:p,alt:"back",class:"back-arrow"})]),(0,a._)("main",null,[(0,a.Wm)(c,{"is-open":r.isConfirmationModalOpen,onConfirm:i.deleteSelectedTask,onCancel:i.closeConfirmationModal},null,8,["is-open","onConfirm","onCancel"]),(0,a._)("ul",m,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.note.tasks,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n,class:"task-list__task task-list__task_center"},[(0,a._)("input",{checked:t.completed,onClick:(0,o.iM)((t=>i.changeStatusOfTask(n)),["prevent"]),class:"task-list__checkbox",type:"checkbox"},null,8,f),(0,a._)("span",null,(0,d.zw)(t.title),1),(0,a._)("img",{onClick:t=>i.openConfirmationModal(n),class:"trash-bin trash-bin_for-task",src:h,alt:"trash-bin"},null,8,k)])))),128))])])],64)}const _=(0,a._)("p",{class:"confirmation__text"},"Вы действительно хотите удалить элемент?",-1),w={class:"confirmation__btns"};function b(t,n,e,s,r,i){return e.isOpen?((0,a.wg)(),(0,a.iD)("div",{key:0,onClick:n[3]||(n[3]=(...t)=>i.cancel&&i.cancel(...t)),class:"modal"},[(0,a._)("div",{onClick:n[2]||(n[2]=(0,o.iM)((()=>{}),["stop"])),class:"confirmation modal_window"},[_,(0,a._)("div",w,[(0,a._)("button",{onClick:n[0]||(n[0]=(...t)=>i.confirm&&i.confirm(...t)),class:"default-btn default-btn_delete"}," Удалить "),(0,a._)("button",{onClick:n[1]||(n[1]=(...t)=>i.cancel&&i.cancel(...t)),class:"default-btn default-btn_cancel"}," Отмена ")])])])):(0,a.kq)("",!0)}var C={name:"AppModalConfirmation",props:{isOpen:{type:Boolean,required:!0}},emits:{confirm:null,cancel:null},mounted(){document.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){document.removeEventListener("keydown",this.handleKeydown)},methods:{handleKeydown(t){this.isOpen&&"Escape"===t.key?this.cancel():this.isOpen&&"Enter"===t.key&&this.confirm()},cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}};const y=(0,i.Z)(C,[["render",b]]);var v=y;const M="notesDatabase";function O(){return new Promise(((t,n)=>{const e=window.indexedDB.open(M,1);e.onsuccess=n=>{const e=n.target.result;t(e)},e.onerror=t=>{n(t.target.error)},e.onupgradeneeded=t=>{const n=t.target.result,e=n.createObjectStore("notes",{keyPath:"id",autoIncrement:!0});e.createIndex("title","title",{unique:!1})}}))}const N=async t=>{const n=await O();return new Promise(((e,o)=>{const s=n.transaction(["notes"],"readwrite"),a=s.objectStore("notes"),r=a.add(t);r.onsuccess=()=>{e(r.result)},r.onerror=t=>{o(t.target.error)}}))},D=async()=>{const t=await O();return new Promise(((n,e)=>{const o=t.transaction(["notes"],"readonly"),s=o.objectStore("notes"),a=s.getAll();a.onsuccess=()=>{n(a.result)},a.onerror=t=>{e(t.target.error)}}))},x=async t=>{const n=await O();return new Promise(((e,o)=>{const s=n.transaction(["notes"],"readwrite"),a=s.objectStore("notes"),r=a.delete(t);r.onsuccess=()=>{e()},r.onerror=t=>{o(t.target.error)}}))},P=async t=>{const n=await O();return new Promise(((e,o)=>{const s=n.transaction(["notes"],"readonly"),a=s.objectStore("notes"),r=a.get(Number(t));r.onsuccess=()=>{const t=r.result;t?e(t):o("Note not found")},r.onerror=t=>{o(t.target.error)}}))},S=async(t,n,e)=>{const o=await O();return new Promise(((s,a)=>{const r=o.transaction(["notes"],"readwrite"),i=r.objectStore("notes"),c=i.get(Number(t));c.onsuccess=t=>{const o=t.target.result;if(o){o.tasks[n].completed=e;const t=i.put(o);t.onsuccess=()=>{s()},t.onerror=t=>{a(t.target.error)}}else a("Note not found")},c.onerror=t=>{a(t.target.error)}}))},j=async(t,n)=>{const e=await O();return new Promise(((o,s)=>{const a=e.transaction(["notes"],"readwrite"),r=a.objectStore("notes"),i=r.get(Number(t));i.onsuccess=t=>{const e=t.target.result;if(e){e.tasks.splice(n,1);const t=r.put(e);t.onsuccess=()=>{o()},t.onerror=t=>{s(t.target.error)}}else s("Note not found")},i.onerror=t=>{s(t.target.error)}}))};var I={components:{AppModalConfirmation:v},data(){return{isConfirmationModalOpen:!1,confirmationIndex:null,note:{}}},created(){P(this.$route.params.id).then((t=>{this.note=t})).catch((t=>{console.error(t),this.$router.push({name:"NotFound"})}))},methods:{changeStatusOfTask(t){S(this.$route.params.id,t,!this.note.tasks[t].completed).then((()=>{this.note.tasks[t].completed=!this.note.tasks[t].completed})).catch((t=>{console.error(t)}))},deleteSelectedTask(){j(this.$route.params.id,this.confirmationIndex).then((()=>{this.note.tasks.splice(this.confirmationIndex,1),this.closeConfirmationModal()})).catch((t=>{console.error(t)}))},openConfirmationModal(t){this.isConfirmationModalOpen=!0,this.confirmationIndex=t},closeConfirmationModal(){this.isConfirmationModalOpen=!1,this.confirmationIndex=null}}};const T=(0,i.Z)(I,[["render",g]]);var $=T;const K=(0,a._)("header",null,[(0,a._)("h1",null,"Мои заметки")],-1),q={key:0,class:"no-notes-message"},E=["onClick"],H={class:"note__title"},Y={class:"task-list"},Z=["checked"],z={key:0,class:"task-list__task task-list__task_etc"},A=["onClick"];function L(t,n,e,s,r,i){const c=(0,a.up)("app-modal-confirmation"),l=(0,a.up)("app-creating-note-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[K,(0,a._)("main",null,[(0,a.Wm)(c,{"is-open":r.isConfirmationModalOpen,onConfirm:i.deleteNote,onCancel:i.closeConfirmationModal},null,8,["is-open","onConfirm","onCancel"]),(0,a.Wm)(l,{"is-open":r.isCreatingModalOpen,onCreating:i.addCurrentNote,onCancel:n[0]||(n[0]=t=>r.isCreatingModalOpen=!1)},null,8,["is-open","onCreating"]),(0,a._)("button",{onClick:n[1]||(n[1]=t=>r.isCreatingModalOpen=!0),class:"default-btn default-btn_create"}," Создать новую заметку "),0===r.notes.length?((0,a.wg)(),(0,a.iD)("p",q,"Заметок пока нет!")):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.notes,(n=>((0,a.wg)(),(0,a.iD)("div",{key:n.id,onClick:e=>t.$router.push({name:"CurrnetNote",params:{id:n.id}}),class:"note"},[(0,a._)("h2",H,(0,d.zw)(n.title),1),(0,a._)("ul",Y,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.tasks.slice(0,2),((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n,class:"task-list__task"},[(0,a._)("input",{checked:t.completed,disabled:"",class:"task-list__checkbox",type:"checkbox"},null,8,Z),(0,a._)("span",null,(0,d.zw)(t.title),1)])))),128)),n.tasks.length>2?((0,a.wg)(),(0,a.iD)("li",z," ... ")):(0,a.kq)("",!0)]),(0,a._)("img",{onClick:(0,o.iM)((t=>i.openConfirmationModal(n.id)),["stop"]),class:"trash-bin",src:h,alt:"trash-bin"},null,8,A)],8,E)))),128))])],64)}const U=(0,a._)("h3",{class:"new-note__title"},"Создание новой заметки",-1),W={class:"new-note__input-wrapper"},B=(0,a._)("hr",{class:"new-note__separator"},null,-1),F={class:"new-note__task-list"},V=["onClick"],R={key:0,class:"new-note__separator"},G=["disabled"];function J(t,n,e,s,r,i){return e.isOpen?((0,a.wg)(),(0,a.iD)("div",{key:0,onClick:n[6]||(n[6]=(...t)=>i.cancel&&i.cancel(...t)),class:"modal"},[(0,a._)("form",{onClick:n[5]||(n[5]=(0,o.iM)((()=>{}),["stop"])),class:"new-note modal_window"},[(0,a._)("button",{onClick:n[0]||(n[0]=(...t)=>i.cancel&&i.cancel(...t)),class:"new-note__close-btn"},"+"),U,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>r.noteName=t),type:"text",class:"input",placeholder:"Введите название заметки"},null,512),[[o.nr,r.noteName]]),(0,a._)("div",W,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":n[2]||(n[2]=t=>r.taskName=t),type:"text",class:"input input_task",placeholder:"Введите название задачи"},null,512),[[o.nr,r.taskName]]),(0,a._)("button",{onClick:n[3]||(n[3]=(0,o.iM)(((...t)=>i.addTask&&i.addTask(...t)),["prevent"])),class:"default-btn"},"+")]),B,(0,a._)("ul",F,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.tasks,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{class:"new-note__task",key:n},[(0,a._)("img",{onClick:t=>i.deleteTask(n),class:"trash-bin trash-bin_for-task",src:h,alt:"trash-bin"},null,8,V),(0,a._)("span",null,(0,d.zw)(t),1)])))),128))]),r.tasks.length>0?((0,a.wg)(),(0,a.iD)("hr",R)):(0,a.kq)("",!0),(0,a._)("button",{onClick:n[4]||(n[4]=(0,o.iM)(((...t)=>i.creating&&i.creating(...t)),["prevent"])),disabled:i.btnDisabled,class:"default-btn"}," Создать заметку ",8,G)])])):(0,a.kq)("",!0)}var Q={props:{isOpen:{type:Boolean,required:!0}},emits:{creating:t=>"string"===typeof t.title&&t.title.length>0&&t.tasks.length>0||(console.warn("Некорректные данные для события creating!"),!1),cancel:null},mounted(){document.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){document.removeEventListener("keydown",this.handleKeydown)},data(){return{noteName:"",taskName:"",tasks:[]}},computed:{btnDisabled(){return 0===this.tasks.length||""===this.noteName}},methods:{handleKeydown(t){this.isOpen&&"Escape"===t.key&&this.cancel()},clearData(){this.noteName="",this.taskName="",this.tasks.length=0},cancel(){this.$emit("cancel"),this.clearData()},creating(){if(this.btnDisabled)return;const t={title:this.noteName,tasks:this.tasks.map((t=>({title:t,completed:!1})))};this.$emit("creating",t),this.clearData()},addTask(){this.taskName&&(this.tasks.push(this.taskName),this.taskName="")},deleteTask(t){this.tasks.splice(t,1)}}};const X=(0,i.Z)(Q,[["render",J]]);var tt=X,nt={components:{AppModalConfirmation:v,AppCreatingNoteModal:tt},data(){return{isConfirmationModalOpen:!1,confirmationId:null,isCreatingModalOpen:!1,notes:[]}},created(){D().then((t=>{this.notes=t})).catch((t=>{console.error(t)}))},methods:{shortenedTasks(t){return t.length<=2?t:t.slice(0,2)},addCurrentNote(t){N(t).then((n=>{this.isCreatingModalOpen=!1,t.id=n,this.notes.push(t)})).catch((t=>{console.error(t)}))},deleteNote(){x(this.confirmationId).then((()=>{const t=this.notes.findIndex((t=>t.id===this.confirmationId));-1!==t&&this.notes.splice(t,1),this.closeConfirmationModal()})).catch((t=>{console.error(t)}))},openConfirmationModal(t){this.isConfirmationModalOpen=!0,this.confirmationId=t},closeConfirmationModal(){this.isConfirmationModalOpen=!1,this.confirmationId=null}}};const et=(0,i.Z)(nt,[["render",L]]);var ot=et;const st=(0,a._)("h1",null,"Страница не найдена!",-1);function at(t,n){return(0,a.wg)(),(0,a.iD)("header",null,[st,(0,a._)("img",{onClick:n[0]||(n[0]=n=>t.$router.push({name:"StartingPage"})),src:p,alt:"back",class:"back-arrow"})])}const rt={},it=(0,i.Z)(rt,[["render",at]]);var ct=it;const lt=(0,s.p7)({history:(0,s.PO)(),routes:[{name:"StartingPage",path:"/",component:ot},{name:"CurrnetNote",path:"/:id(\\d+)",component:$},{name:"NotFound",path:"/:pathMatch(.*)*",component:ct}]});(0,o.ri)(u).use(lt).mount("#app")}},n={};function e(o){var s=n[o];if(void 0!==s)return s.exports;var a=n[o]={exports:{}};return t[o].call(a.exports,a,a.exports,e),a.exports}e.m=t,function(){var t=[];e.O=function(n,o,s,a){if(!o){var r=1/0;for(u=0;u<t.length;u++){o=t[u][0],s=t[u][1],a=t[u][2];for(var i=!0,c=0;c<o.length;c++)(!1&a||r>=a)&&Object.keys(e.O).every((function(t){return e.O[t](o[c])}))?o.splice(c--,1):(i=!1,a<r&&(r=a));if(i){t.splice(u--,1);var l=s();void 0!==l&&(n=l)}}return n}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[o,s,a]}}(),function(){e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,{a:n}),n}}(),function(){e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(),function(){e.p="/"}(),function(){var t={143:0};e.O.j=function(n){return 0===t[n]};var n=function(n,o){var s,a,r=o[0],i=o[1],c=o[2],l=0;if(r.some((function(n){return 0!==t[n]}))){for(s in i)e.o(i,s)&&(e.m[s]=i[s]);if(c)var u=c(e)}for(n&&n(o);l<r.length;l++)a=r[l],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(u)},o=self["webpackChunknotes_app"]=self["webpackChunknotes_app"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=e.O(void 0,[998],(function(){return e(7893)}));o=e.O(o)})();
//# sourceMappingURL=app.22b96d82.js.map